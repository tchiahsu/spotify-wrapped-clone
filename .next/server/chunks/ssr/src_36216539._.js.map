{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/tonyhsu/Desktop/projects/spotify-wrapped/src/lib/spotify.tsx"],"sourcesContent":["/**\n * It loads the verifier from local storage and using both the code returned from the callback and the\n * verifier to perfrom a POST to the Spotify token API. The API uses two values to verify the request and\n * it returns an access token.\n */\nexport async function getAccessToken(clientId: string, code: string): Promise<string> {\n    const verifier = localStorage.getItem(\"verifier\")\n    const redirectUri = `https://tchiahsu.github.io/spotify-wrapped-clone/callback`;\n\n    if (!verifier) {\n        console.log(\"Missing Verifier Error\")\n        throw new Error(\"Missing Verifier\")\n    }\n\n    const params = new URLSearchParams();\n    params.append(\"client_id\", clientId);\n    params.append(\"grant_type\", \"authorization_code\");\n    params.append(\"code\", code);\n    params.append(\"redirect_uri\", redirectUri);\n    params.append(\"code_verifier\", verifier!);\n\n    const result = await fetch(\"https://accounts.spotify.com/api/token\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" },\n        body: params\n    });\n\n    const { access_token } = await result.json();\n\n    console.log(`Client Id: ${clientId}`)\n    console.log(`Code: ${code}`)\n    console.log(`Verifier: ${verifier}`)\n    console.log(`Access Token: ${access_token}`)\n\n    return access_token;\n}\n\n/**\n * Fetch User Top 5 Artists\n */\nexport async function fetchTopArtists(token: string) {\n    const result = await fetch(\"https://api.spotify.com/v1/me/top/artists?time_range=long_term&limit=5\", {\n        method: \"GET\",\n        headers: { Authorization: `Bearer ${token}` },\n    });\n\n    if (!result.ok) {\n        throw new Error(`Spotify API error: ${result.status} ${result.statusText}`)\n    }\n\n    return await result.json()\n}\n\n/**\n * Fetch User Top 50 Tracks\n */\nexport async function fetchTopTracks(token: string) {\n    const result = await fetch(\"https://api.spotify.com/v1/me/top/tracks?time_range=long_term&limit=50\", {\n        method: \"GET\",\n        headers: { Authorization: `Bearer ${token}` }\n    });\n\n    if (!result.ok) {\n        throw new Error(`Spotify API error: ${result.status} ${result.statusText}`)\n    }\n\n    return await result.json()\n}\n\n/**\n * Batch artists for unique IDs\n */\nexport async function getUniqueArtists(token: string, artistsId: string[]) {\n    const batchIds = artistsId.join(\",\");\n    console.log(batchIds)\n    const result = await fetch(`https://api.spotify.com/v1/artists?ids=${batchIds}`, {\n        headers: { Authorization: `Bearer ${token}` }\n    });\n\n    if (!result.ok) {\n        throw new Error(`Failed to fetch artists: ${result.statusText}`)\n    }\n\n    return await result.json()\n}\n\n/**\n * Create Top 50 song playlist\n */\nexport async function createPlaylist(token: string, userId: string) {\n    const body = {\n        name: \"My Wrapped • Top 50\",\n        description: \"Your Top 50 Tracks from Spotify long term data\",\n        public: false\n    }\n\n    const result = await fetch(`https://api.spotify.com/v1/users/${userId}/playlists`, {\n        method: \"POST\",\n        headers: { Authorization: `Bearer ${token}`, \"Content-Type\": `application/json` },\n        body: JSON.stringify(body)\n    })\n\n    if (!result.ok) {\n        throw new Error(`Failed to create playlist: ${result.statusText}`)\n    }\n\n    return await result.json();\n}\n\n/**\n * Add Tracks to Playlist\n */\nexport async function addTrackToPlaylist(token: string, playlistId: string, trackUris: string[]) {\n    const result = await fetch(`https://api.spotify.com/v1/playlists/${playlistId}/tracks`, {\n        method: \"POST\",\n        headers: { Authorization: `Bearer ${token}`, \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ uris: trackUris})\n    })\n\n    if (!result.ok) {\n        throw new Error(`Failed to add tracks: ${result.statusText}`);\n    }\n\n    return result.json();\n}\n\n/**\n * A call is made using the browser's Fetch API to get the profile data.\n * The authorization header, is set to Bearer TOKEN, where token is the access token\n * that we get from the spotify endpoint\n */\nexport async function fetchProfile(token: string) {\n    const result = await fetch(\"https://api.spotify.com/v1/me\", {\n        method: \"GET\", headers: { Authorization: `Bearer ${token}` }\n    });\n\n    return await result.json();\n}\n"],"names":[],"mappings":"AAAA;;;;CAIC;;;;;;;;;;;;;;;;AACM,eAAe,eAAe,QAAgB,EAAE,IAAY;IAC/D,MAAM,WAAW,aAAa,OAAO,CAAC;IACtC,MAAM,cAAc,CAAC,yDAAyD,CAAC;IAE/E,IAAI,CAAC,UAAU;QACX,QAAQ,GAAG,CAAC;QACZ,MAAM,IAAI,MAAM;IACpB;IAEA,MAAM,SAAS,IAAI;IACnB,OAAO,MAAM,CAAC,aAAa;IAC3B,OAAO,MAAM,CAAC,cAAc;IAC5B,OAAO,MAAM,CAAC,QAAQ;IACtB,OAAO,MAAM,CAAC,gBAAgB;IAC9B,OAAO,MAAM,CAAC,iBAAiB;IAE/B,MAAM,SAAS,MAAM,MAAM,0CAA0C;QACjE,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAoC;QAC/D,MAAM;IACV;IAEA,MAAM,EAAE,YAAY,EAAE,GAAG,MAAM,OAAO,IAAI;IAE1C,QAAQ,GAAG,CAAC,CAAC,WAAW,EAAE,UAAU;IACpC,QAAQ,GAAG,CAAC,CAAC,MAAM,EAAE,MAAM;IAC3B,QAAQ,GAAG,CAAC,CAAC,UAAU,EAAE,UAAU;IACnC,QAAQ,GAAG,CAAC,CAAC,cAAc,EAAE,cAAc;IAE3C,OAAO;AACX;AAKO,eAAe,gBAAgB,KAAa;IAC/C,MAAM,SAAS,MAAM,MAAM,0EAA0E;QACjG,QAAQ;QACR,SAAS;YAAE,eAAe,CAAC,OAAO,EAAE,OAAO;QAAC;IAChD;IAEA,IAAI,CAAC,OAAO,EAAE,EAAE;QACZ,MAAM,IAAI,MAAM,CAAC,mBAAmB,EAAE,OAAO,MAAM,CAAC,CAAC,EAAE,OAAO,UAAU,EAAE;IAC9E;IAEA,OAAO,MAAM,OAAO,IAAI;AAC5B;AAKO,eAAe,eAAe,KAAa;IAC9C,MAAM,SAAS,MAAM,MAAM,0EAA0E;QACjG,QAAQ;QACR,SAAS;YAAE,eAAe,CAAC,OAAO,EAAE,OAAO;QAAC;IAChD;IAEA,IAAI,CAAC,OAAO,EAAE,EAAE;QACZ,MAAM,IAAI,MAAM,CAAC,mBAAmB,EAAE,OAAO,MAAM,CAAC,CAAC,EAAE,OAAO,UAAU,EAAE;IAC9E;IAEA,OAAO,MAAM,OAAO,IAAI;AAC5B;AAKO,eAAe,iBAAiB,KAAa,EAAE,SAAmB;IACrE,MAAM,WAAW,UAAU,IAAI,CAAC;IAChC,QAAQ,GAAG,CAAC;IACZ,MAAM,SAAS,MAAM,MAAM,CAAC,uCAAuC,EAAE,UAAU,EAAE;QAC7E,SAAS;YAAE,eAAe,CAAC,OAAO,EAAE,OAAO;QAAC;IAChD;IAEA,IAAI,CAAC,OAAO,EAAE,EAAE;QACZ,MAAM,IAAI,MAAM,CAAC,yBAAyB,EAAE,OAAO,UAAU,EAAE;IACnE;IAEA,OAAO,MAAM,OAAO,IAAI;AAC5B;AAKO,eAAe,eAAe,KAAa,EAAE,MAAc;IAC9D,MAAM,OAAO;QACT,MAAM;QACN,aAAa;QACb,QAAQ;IACZ;IAEA,MAAM,SAAS,MAAM,MAAM,CAAC,iCAAiC,EAAE,OAAO,UAAU,CAAC,EAAE;QAC/E,QAAQ;QACR,SAAS;YAAE,eAAe,CAAC,OAAO,EAAE,OAAO;YAAE,gBAAgB,CAAC,gBAAgB,CAAC;QAAC;QAChF,MAAM,KAAK,SAAS,CAAC;IACzB;IAEA,IAAI,CAAC,OAAO,EAAE,EAAE;QACZ,MAAM,IAAI,MAAM,CAAC,2BAA2B,EAAE,OAAO,UAAU,EAAE;IACrE;IAEA,OAAO,MAAM,OAAO,IAAI;AAC5B;AAKO,eAAe,mBAAmB,KAAa,EAAE,UAAkB,EAAE,SAAmB;IAC3F,MAAM,SAAS,MAAM,MAAM,CAAC,qCAAqC,EAAE,WAAW,OAAO,CAAC,EAAE;QACpF,QAAQ;QACR,SAAS;YAAE,eAAe,CAAC,OAAO,EAAE,OAAO;YAAE,gBAAgB;QAAmB;QAChF,MAAM,KAAK,SAAS,CAAC;YAAE,MAAM;QAAS;IAC1C;IAEA,IAAI,CAAC,OAAO,EAAE,EAAE;QACZ,MAAM,IAAI,MAAM,CAAC,sBAAsB,EAAE,OAAO,UAAU,EAAE;IAChE;IAEA,OAAO,OAAO,IAAI;AACtB;AAOO,eAAe,aAAa,KAAa;IAC5C,MAAM,SAAS,MAAM,MAAM,iCAAiC;QACxD,QAAQ;QAAO,SAAS;YAAE,eAAe,CAAC,OAAO,EAAE,OAAO;QAAC;IAC/D;IAEA,OAAO,MAAM,OAAO,IAAI;AAC5B","debugId":null}},
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":["file:///Users/tonyhsu/Desktop/projects/spotify-wrapped/src/components/Tag.tsx"],"sourcesContent":["import React from \"react\";\n\ntype TagProps = {\n    children: React.ReactNode;\n};\n\nconst Tag = ({ children }: TagProps) => {\n    return (\n        <div\n            className=\"bg-[#1db954] w-1/6 min-w-[14em] max-w-[15em] px-6 py-3 rounded-full font-bold text-black text-center justify-center items-center\"\n        >\n            {children}\n        </div>\n    )\n}\n\nexport default Tag;"],"names":[],"mappings":";;;;;;AAMA,MAAM,MAAM,CAAC,EAAE,QAAQ,EAAY;IAC/B,qBACI,8OAAC;QACG,WAAU;kBAET;;;;;;AAGb;uCAEe","debugId":null}},
    {"offset": {"line": 157, "column": 0}, "map": {"version":3,"sources":["file:///Users/tonyhsu/Desktop/projects/spotify-wrapped/src/app/callback/page.tsx"],"sourcesContent":["\"use client\"\nimport { Suspense, useEffect, useRef } from \"react\";\nimport { useSearchParams, useRouter } from \"next/navigation\";\nimport { getAccessToken } from \"lib/spotify\";\nimport Tag from \"../../components/Tag\";\nimport Image from \"next/image\";\n\nfunction CallbackContent() {\n    const router = useRouter();\n    const params = useSearchParams();\n    const code = params.get(\"code\");\n    const ranRef = useRef(false);\n\n    useEffect(() => {\n        if (!code) return;\n        if (ranRef.current) return;\n        ranRef.current = true;\n\n        (async () => {\n            try {\n                const clientId = localStorage.getItem(\"clientId\");\n                if (!clientId) throw new Error(\"Client ID is invalid of null.\");\n                \n                const token = await getAccessToken(clientId, code);\n                if (!token) throw new Error(\"No access token returned.\");\n\n                localStorage.setItem(\"token\", token);\n\n                setTimeout(() => {\n                    router.push(\"/dashboard\");\n                }, 600);\n            } catch (error) {\n                console.error(\"Error getting Access Token:\", error)\n            }\n        })();\n    }, [code, router]);\n\n    return (\n        <>\n            <main className=\"flex flex-col h-screen w-screen justify-center items-center mt-[-50px] gap-7 sm:items-center\">\n                {/* Spotify Logo */}\n                <Image\n                    src=\"/spotify_white.png\"\n                    alt=\"spotify logo\"\n                    width={50}\n                    height={50}\n                />\n\n                {/* Intro Title */}\n                <div className=\"flex flex-col gap-2 items-center\">\n                    <div className=\"text-6xl font-bold text-center\">Authenticating your Account!</div>\n                    <div className=\"text-xl text-center\">This will only take a few seconds.</div>\n                </div>\n\n                {/* Authenticating Tag */}\n                <Tag>\n                    <div className=\"flex justify-center items-center gap-2\">\n                        <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-black\"></div>\n                        <span className=\"ml-2\">Authenticating...</span>\n                    </div>\n                </Tag>\n            </main>\n            <footer className=\"flex flex-col justify-center items-center text-center text-xs text-[#7c7c7c]\">\n                <div>Built with Next.js & Spotify Web API | Not affiliated with Spotify.</div>\n                <div>© 2025 Tony Hsu Tai</div>\n            </footer>\n        </>\n    );\n}\n\nexport default function Callback() {\n    return (\n        <Suspense fallback={\n            <main className=\"flex flex-col h-screen w-screen justify-center items-center\">\n                <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-white\"></div>\n            </main>\n        }>\n            <CallbackContent />\n        </Suspense>\n    );\n}"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AALA;;;;;;;AAOA,SAAS;IACL,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,SAAS,IAAA,qJAAe;IAC9B,MAAM,OAAO,OAAO,GAAG,CAAC;IACxB,MAAM,SAAS,IAAA,+MAAM,EAAC;IAEtB,IAAA,kNAAS,EAAC;QACN,IAAI,CAAC,MAAM;QACX,IAAI,OAAO,OAAO,EAAE;QACpB,OAAO,OAAO,GAAG;QAEjB,CAAC;YACG,IAAI;gBACA,MAAM,WAAW,aAAa,OAAO,CAAC;gBACtC,IAAI,CAAC,UAAU,MAAM,IAAI,MAAM;gBAE/B,MAAM,QAAQ,MAAM,IAAA,wIAAc,EAAC,UAAU;gBAC7C,IAAI,CAAC,OAAO,MAAM,IAAI,MAAM;gBAE5B,aAAa,OAAO,CAAC,SAAS;gBAE9B,WAAW;oBACP,OAAO,IAAI,CAAC;gBAChB,GAAG;YACP,EAAE,OAAO,OAAO;gBACZ,QAAQ,KAAK,CAAC,+BAA+B;YACjD;QACJ,CAAC;IACL,GAAG;QAAC;QAAM;KAAO;IAEjB,qBACI;;0BACI,8OAAC;gBAAK,WAAU;;kCAEZ,8OAAC,wIAAK;wBACF,KAAI;wBACJ,KAAI;wBACJ,OAAO;wBACP,QAAQ;;;;;;kCAIZ,8OAAC;wBAAI,WAAU;;0CACX,8OAAC;gCAAI,WAAU;0CAAiC;;;;;;0CAChD,8OAAC;gCAAI,WAAU;0CAAsB;;;;;;;;;;;;kCAIzC,8OAAC,oIAAG;kCACA,cAAA,8OAAC;4BAAI,WAAU;;8CACX,8OAAC;oCAAI,WAAU;;;;;;8CACf,8OAAC;oCAAK,WAAU;8CAAO;;;;;;;;;;;;;;;;;;;;;;;0BAInC,8OAAC;gBAAO,WAAU;;kCACd,8OAAC;kCAAI;;;;;;kCACL,8OAAC;kCAAI;;;;;;;;;;;;;;AAIrB;AAEe,SAAS;IACpB,qBACI,8OAAC,iNAAQ;QAAC,wBACN,8OAAC;YAAK,WAAU;sBACZ,cAAA,8OAAC;gBAAI,WAAU;;;;;;;;;;;kBAGnB,cAAA,8OAAC;;;;;;;;;;AAGb","debugId":null}}]
}